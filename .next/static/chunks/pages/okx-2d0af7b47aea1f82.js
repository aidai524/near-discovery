(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9775],{54873:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/okx",function(){return a(31595)}])},31595:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var i=a(85893),c=a(85518),s=a(51991),n=a(80132),o=a(47041),r=a(11163),l=a(67294),u=a(55054),d=a(42501),h=a(59397),w=a(49775),f=a(46545),v=a(79240),g=a(4669),m=a(78579),x=a(12302),y=a(72912),k=a(43333),p=a(83812),S=a(13777),j=a(92357),_=(0,l.memo)(e=>{let{from:t,inviteCode:a,platform:c}=e,{check:s}=(0,h.Z)({isNeedAk:!0,isQuiet:!0}),{loading:_,list:C,page:E,info:N,maxPage:U,handlePageChange:T,handleRefresh:P}=(0,S.Z)(c),{copy:R}=(0,w.Z)(),[{wallet:Z,connecting:D},b,q]=(0,n.Or)();(0,r.useRouter)();let[O,X]=(0,l.useState)("Quests"),[A,z]=(0,l.useState)(""),[Q,W]=(0,l.useState)(!1),[F,J]=(0,l.useState)("success");(0,y.Z)();let[K,L]=(0,l.useState)(!1),[Y,H]=(0,l.useState)("uncheck"),[I,M]=(0,l.useState)([]),[B,G]=(0,l.useState)([]),[V,$]=(0,l.useState)(0),[ee,et]=(0,l.useState)(0),[ea,ei]=(0,l.useState)(0),[ec,es]=(0,l.useState)(0),[en,eo]=(0,l.useState)(),{userInfo:er,queryUserInfo:el}=(0,f.Z)(),{info:eu,queryUserReward:ed}=(0,v.Z)(),[eh,ew]=(0,l.useState)(!1),[ef,ev]=(0,l.useState)({height:0}),[eg,em]=(0,l.useState)(0),[ex,ey]=(0,l.useState)(0),[ek,ep]=(0,l.useState)(0),[eS,ej]=(0,l.useState)([]),[e_,eC]=(0,l.useState)(!1),[eE,eN]=(0,l.useState)([!1,!1,!1,!1]),[eU,eT]=(0,l.useState)(!1),eP="".concat(window.location.origin).concat(window.location.pathname);console.log("redirectUri: ",eP);let{loading:eR,type:eZ,handleBind:eD}=(0,x.Z)({onSuccess:()=>{es(Date.now()),el()},redirect_uri:eP});async function eb(){let e=await (0,m.U2)("".concat(d.h,"/api/activity/check_account?category=").concat(c));if(0!==e.code)return;let t=e.data.is_activity?"new":"old";H(t)}async function eq(){let e=await (0,m.jo)("".concat(d.h,"/api/invite/check-address/").concat(A),c);0===e.code&&e.data.is_activated&&eA()}async function eO(){let e=await (0,m.U2)("".concat(d.h,"/api/invite/check-address/").concat(A));0===e.code&&(e.data.is_activated?eA():eX())}async function eX(){let e=await (0,m.v_)("".concat(d.h,"/api/invite/activate"),{address:A});e.data.is_success&&eA()}async function eA(){await (0,u.hP)(A),(0,o.setCookie)("AUTHED_ACCOUNT",A),eb()}async function ez(){let e=await (0,m.U2)("".concat(d.h,"/api/activity/quest_list?category=").concat(c));if(eC(!1),eN([!1,!1,!1,!1]),0!==e.code)return;let{advanced_quests:t,basic_quests:a}=e.data;M(t),G(a)}async function eQ(){let e=await (0,m.U2)("".concat(d.h,"/api/invite/list"));if(0===e.code)return e.data}async function eW(){var e,t;let a=await (0,m.U2)("".concat(d.h,"/api/activity/reward?category=").concat(c));0===a.code&&(eC(!1),eN([!1,!1,!1,!1]),ep((null===(e=a.data)||void 0===e?void 0:e.reward)||0),et((null===(t=a.data)||void 0===t?void 0:t.rank)||0))}(0,l.useEffect)(()=>{if(Z){var e;z(null===(e=Z.accounts[0])||void 0===e?void 0:e.address)}},[Z]);let eF=async()=>{var e;let t=await eQ();em(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.length),ey(null==t?void 0:t.invite_reward)};async function eJ(e){let t=await (0,m.v_)("".concat(d.h,"/api/activity/claim"),{quest_id:e});return 0===t.code}let eK=()=>{ei(e=>e+1),es(Date.now())},eL=async e=>{if(console.log("handleClaim--",A,e),A&&"completed"===e.status&&!e.is_claimed&&!eh){ew(!0);try{let t=await eJ(e.id);ew(!1),t&&(W(!0),J("success"),$(e.reward),ed(),eK())}catch(e){ew(!1)}}};return(0,l.useEffect)(()=>{ez(),"uncheck"!==Y&&"old"===Y&&(W(!0),J("fail"))},[Y,ea]),(0,l.useEffect)(()=>{"new"===Y&&L(!1),"old"!==Y&&"uncheck"!==Y&&A||L(!0)},[Y,A]),(0,l.useEffect)(()=>{A&&(es(Date.now()),"bg"===t&&eq(),"bgUser"===t&&eO())},[A]),(0,l.useEffect)(()=>{K||s(()=>{eW(),eF()})},[ec,K]),location.origin,(0,i.jsxs)(j.W2,{children:[(0,i.jsxs)(j.jL,{className:c,children:[(0,i.jsxs)(j.TR,{children:[(0,i.jsx)(j.Rm,{src:"/images/marketing/dap-logo.svg"}),(0,i.jsx)(j.ie,{src:"/images/marketing/X.svg"}),(0,i.jsx)(j.oX,{src:p.y.get(c)}),(0,i.jsx)("div",{className:"partner",children:"OKX Wallet"})]}),(0,i.jsx)(j.p2,{children:"Ready to Claim Your Exclusive Rewards?Just Connect Your Wallet!"})]}),(0,i.jsxs)(j.xu,{children:[(0,i.jsx)(j.Tr,{children:"Complete wallet connections to unlock your PTS."}),(0,i.jsx)(j.h8,{children:Z&&A?B.map(e=>e.is_claimed?(0,i.jsx)(j.zx,{id:e.id,style:{cursor:"not-allowed"},children:"Reward Already Claimed"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(j.zx,{id:e.id,onClick:t=>eL(e),children:["Claim your",(0,i.jsx)(j.sN,{src:"/images/marketing/coin.svg"})," ",e.reward," PTS"]}),(0,i.jsx)(j.wC,{className:e_?"spin":"",src:"/images/marketing/fresh.svg",onClick:()=>{eC(!0),eK()}})]})):(0,i.jsxs)(j.zx,{onClick:()=>{b()},children:["Connect wallet ",(0,i.jsx)(j.sN,{src:"/images/marketing/coin.svg"})," 200 PTS"]})})]}),(0,i.jsxs)(j.qK,{children:[(0,i.jsx)(j.P9,{children:"Ready to Ignite the Spark?"}),(0,i.jsx)(j.Ux,{src:"/images/marketing/star.png"})]}),(0,i.jsx)(j.rU,{onClick:g.l,children:"For more quests and more rewards, visit DapDap"}),(0,i.jsx)(k.MP,{type:F,open:Q,onClose:()=>W(!1),reward:V})]})});let C=()=>(0,i.jsx)(_,{platform:"okx",from:"bg"});C.getLayout=c.tq?s.Ju:s.wQ;var E=C}},function(e){e.O(0,[4473,533,4722,1693,1072,5772,5524,1991,3333,9677,9774,2888,179],function(){return e(e.s=54873)}),_N_E=e.O()}]);